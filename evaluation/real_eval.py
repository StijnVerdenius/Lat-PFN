from data.real.csv_dataset import RealCSVDataset

from torch.utils.data import DataLoader

from functools import partial

from util.config_util import *


def infinite_dataloader(loader):
    while True:
        for data in loader:
            yield data


illness_eval_config = dict(
    context_sources=[
        [
            "datasets/illness_v2/TOTAL_PATIENTS/2008.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2009.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2010.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2011.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2012.csv",
        ],
        [
            "datasets/illness_v2/TOTAL_PATIENTS/2013.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2014.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2015.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2016.csv",
            "datasets/illness_v2/TOTAL_PATIENTS/2017.csv",
        ],
        [
            "datasets/illness_v2/AGE_65/2008.csv",
            "datasets/illness_v2/AGE_65/2009.csv",
            "datasets/illness_v2/AGE_65/2010.csv",
            "datasets/illness_v2/AGE_65/2011.csv",
            "datasets/illness_v2/AGE_65/2012.csv",
        ],
        [
            "datasets/illness_v2/AGE_65/2013.csv",
            "datasets/illness_v2/AGE_65/2014.csv",
            "datasets/illness_v2/AGE_65/2015.csv",
            "datasets/illness_v2/AGE_65/2016.csv",
            "datasets/illness_v2/AGE_65/2017.csv",
        ],
        [
            "datasets/illness_v2/AGE_0-4/2008.csv",
            "datasets/illness_v2/AGE_0-4/2009.csv",
            "datasets/illness_v2/AGE_0-4/2010.csv",
            "datasets/illness_v2/AGE_0-4/2011.csv",
            "datasets/illness_v2/AGE_0-4/2012.csv",
        ],
        [
            "datasets/illness_v2/AGE_0-4/2013.csv",
            "datasets/illness_v2/AGE_0-4/2014.csv",
            "datasets/illness_v2/AGE_0-4/2015.csv",
            "datasets/illness_v2/AGE_0-4/2016.csv",
            "datasets/illness_v2/AGE_0-4/2017.csv",
        ],
        [
            "datasets/illness_v2/AGE_5-24/2008.csv",
            "datasets/illness_v2/AGE_5-24/2009.csv",
            "datasets/illness_v2/AGE_5-24/2010.csv",
            "datasets/illness_v2/AGE_5-24/2011.csv",
            "datasets/illness_v2/AGE_5-24/2012.csv",
        ],
        [
            "datasets/illness_v2/AGE_5-24/2013.csv",
            "datasets/illness_v2/AGE_5-24/2014.csv",
            "datasets/illness_v2/AGE_5-24/2015.csv",
            "datasets/illness_v2/AGE_5-24/2016.csv",
            "datasets/illness_v2/AGE_5-24/2017.csv",
        ],
    ],
    target_sources=[
        [
            "datasets/illness_v2/ILITOTAL/2018.csv",
            "datasets/illness_v2/ILITOTAL/2019.csv",
            "datasets/illness_v2/ILITOTAL/2020.csv",
            "datasets/illness_v2/ILITOTAL/2021.csv",
            "datasets/illness_v2/ILITOTAL/2022.csv",
        ],
        [
            "datasets/illness_v2/ILITOTAL/2018.csv",  # identical to the first one because of shapes
            "datasets/illness_v2/ILITOTAL/2019.csv",
            "datasets/illness_v2/ILITOTAL/2020.csv",
            "datasets/illness_v2/ILITOTAL/2021.csv",
            "datasets/illness_v2/ILITOTAL/2022.csv",
        ],
    ],
    shape=ShapeConfig(
        n_sequence=160,
        n_context=8,
        n_features=1,
        n_prompt=40,
        n_heldout=2,
    ),
    T_mapping=partial(normalize, maximum=1, minimum=-3),
    V_mapping=normalize_V_mean_2std,
    disable_context=False,
    name="illness",
)
ett_h_1_eval_config = dict(
    context_sources=[
        [
            "datasets/ett_v2/ETTh1/HUFL/2017_1.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_2.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_3.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_4.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/HUFL/2017_1.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_2.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_3.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_4.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/HULL/2017_1.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_2.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_3.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_4.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/HULL/2017_1.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_2.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_3.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_4.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/LUFL/2017_1.csv",
            "datasets/ett_v2/ETTh1/LUFL/2017_2.csv",
            "datasets/ett_v2/ETTh1/LUFL/2017_3.csv",
            "datasets/ett_v2/ETTh1/LUFL/2017_4.csv",
            "datasets/ett_v2/ETTh1/LUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/LUFL/2017_1.csv",
            "datasets/ett_v2/ETTh2/LUFL/2017_2.csv",
            "datasets/ett_v2/ETTh2/LUFL/2017_3.csv",
            "datasets/ett_v2/ETTh2/LUFL/2017_4.csv",
            "datasets/ett_v2/ETTh2/LUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/LULL/2017_1.csv",
            "datasets/ett_v2/ETTh1/LULL/2017_2.csv",
            "datasets/ett_v2/ETTh1/LULL/2017_3.csv",
            "datasets/ett_v2/ETTh1/LULL/2017_4.csv",
            "datasets/ett_v2/ETTh1/LULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/LULL/2017_1.csv",
            "datasets/ett_v2/ETTh2/LULL/2017_2.csv",
            "datasets/ett_v2/ETTh2/LULL/2017_3.csv",
            "datasets/ett_v2/ETTh2/LULL/2017_4.csv",
            "datasets/ett_v2/ETTh2/LULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/MUFL/2017_1.csv",
            "datasets/ett_v2/ETTh1/MUFL/2017_2.csv",
            "datasets/ett_v2/ETTh1/MUFL/2017_3.csv",
            "datasets/ett_v2/ETTh1/MUFL/2017_4.csv",
            "datasets/ett_v2/ETTh1/MUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/MUFL/2017_1.csv",
            "datasets/ett_v2/ETTh2/MUFL/2017_2.csv",
            "datasets/ett_v2/ETTh2/MUFL/2017_3.csv",
            "datasets/ett_v2/ETTh2/MUFL/2017_4.csv",
            "datasets/ett_v2/ETTh2/MUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/MULL/2017_1.csv",
            "datasets/ett_v2/ETTh1/MULL/2017_2.csv",
            "datasets/ett_v2/ETTh1/MULL/2017_3.csv",
            "datasets/ett_v2/ETTh1/MULL/2017_4.csv",
            "datasets/ett_v2/ETTh1/MULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/MULL/2017_1.csv",
            "datasets/ett_v2/ETTh2/MULL/2017_2.csv",
            "datasets/ett_v2/ETTh2/MULL/2017_3.csv",
            "datasets/ett_v2/ETTh2/MULL/2017_4.csv",
            "datasets/ett_v2/ETTh2/MULL/2017_5.csv",
        ],
    ],
    target_sources=[
        [
            "datasets/ett_v2/ETTh1/OT/2018_1.csv",
            "datasets/ett_v2/ETTh1/OT/2018_2.csv",
            "datasets/ett_v2/ETTh1/OT/2018_3.csv",
            "datasets/ett_v2/ETTh1/OT/2018_4.csv",
            "datasets/ett_v2/ETTh1/OT/2018_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/OT/2018_1.csv",  # identical to the first one because of shapes
            "datasets/ett_v2/ETTh1/OT/2018_2.csv",
            "datasets/ett_v2/ETTh1/OT/2018_3.csv",
            "datasets/ett_v2/ETTh1/OT/2018_4.csv",
            "datasets/ett_v2/ETTh1/OT/2018_5.csv",
        ],
    ],
    shape=ShapeConfig(
        n_sequence=240,
        n_context=12,
        n_features=1,
        n_heldout=2,
        n_prompt=60,
    ),
    T_mapping=partial(normalize, maximum=1, minimum=-3),
    V_mapping=normalize_V_mean_2std,
    stride=10,
    name="ett_h_1",
)


ett_h_2_eval_config = dict(
    context_sources=[
        [
            "datasets/ett_v2/ETTh1/HULL/2017_1.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_2.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_3.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_4.csv",
            "datasets/ett_v2/ETTh1/HULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh1/HUFL/2017_1.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_2.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_3.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_4.csv",
            "datasets/ett_v2/ETTh1/HUFL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/HULL/2017_1.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_2.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_3.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_4.csv",
            "datasets/ett_v2/ETTh2/HULL/2017_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/HUFL/2017_1.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_2.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_3.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_4.csv",
            "datasets/ett_v2/ETTh2/HUFL/2017_5.csv",
        ],
    ],
    target_sources=[
        [
            "datasets/ett_v2/ETTh2/OT/2018_1.csv",
            "datasets/ett_v2/ETTh2/OT/2018_2.csv",
            "datasets/ett_v2/ETTh2/OT/2018_3.csv",
            "datasets/ett_v2/ETTh2/OT/2018_4.csv",
            "datasets/ett_v2/ETTh2/OT/2018_5.csv",
        ],
        [
            "datasets/ett_v2/ETTh2/OT/2018_1.csv",  # identical to the first one because of shapes
            "datasets/ett_v2/ETTh2/OT/2018_2.csv",
            "datasets/ett_v2/ETTh2/OT/2018_3.csv",
            "datasets/ett_v2/ETTh2/OT/2018_4.csv",
            "datasets/ett_v2/ETTh2/OT/2018_5.csv",
        ],
    ],
    shape=ShapeConfig(
        n_sequence=240,
        n_context=4,
        n_features=1,
        n_heldout=2,
        n_prompt=60,
    ),
    T_mapping=partial(normalize, maximum=1, minimum=-3),
    V_mapping=normalize_V_mean_2std,
    stride=10,
    name="ett_h_2",
)

traffic_eval_config = dict(
    context_sources=[
        [
            "datasets/traffic_v2/120/2016_11.csv",
            "datasets/traffic_v2/120/2016_12.csv",
            "datasets/traffic_v2/120/2017_1.csv",
            "datasets/traffic_v2/120/2017_2.csv",
            "datasets/traffic_v2/120/2017_3.csv",
            "datasets/traffic_v2/120/2017_4.csv",
            "datasets/traffic_v2/120/2017_5.csv",
        ],
        [
            "datasets/traffic_v2/293/2016_11.csv",
            "datasets/traffic_v2/293/2016_12.csv",
            "datasets/traffic_v2/293/2017_1.csv",
            "datasets/traffic_v2/293/2017_2.csv",
            "datasets/traffic_v2/293/2017_3.csv",
            "datasets/traffic_v2/293/2017_4.csv",
            "datasets/traffic_v2/293/2017_5.csv",
        ],
        [
            "datasets/traffic_v2/710/2016_11.csv",
            "datasets/traffic_v2/710/2016_12.csv",
            "datasets/traffic_v2/710/2017_1.csv",
            "datasets/traffic_v2/710/2017_2.csv",
            "datasets/traffic_v2/710/2017_3.csv",
            "datasets/traffic_v2/710/2017_4.csv",
            "datasets/traffic_v2/710/2017_5.csv",
        ],
        [
            "datasets/traffic_v2/405/2016_11.csv",
            "datasets/traffic_v2/405/2016_12.csv",
            "datasets/traffic_v2/405/2017_1.csv",
            "datasets/traffic_v2/405/2017_2.csv",
            "datasets/traffic_v2/405/2017_3.csv",
            "datasets/traffic_v2/405/2017_4.csv",
            "datasets/traffic_v2/405/2017_5.csv",
        ],
        [
            "datasets/traffic_v2/120/2016_10.csv",
            "datasets/traffic_v2/120/2016_11.csv",
            "datasets/traffic_v2/120/2016_12.csv",
            "datasets/traffic_v2/120/2017_1.csv",
            "datasets/traffic_v2/120/2017_2.csv",
            "datasets/traffic_v2/120/2017_3.csv",
            "datasets/traffic_v2/120/2017_4.csv",
        ],
        [
            "datasets/traffic_v2/293/2016_10.csv",
            "datasets/traffic_v2/293/2016_11.csv",
            "datasets/traffic_v2/293/2016_12.csv",
            "datasets/traffic_v2/293/2017_1.csv",
            "datasets/traffic_v2/293/2017_2.csv",
            "datasets/traffic_v2/293/2017_3.csv",
            "datasets/traffic_v2/293/2017_4.csv",
        ],
        [
            "datasets/traffic_v2/710/2016_10.csv",
            "datasets/traffic_v2/710/2016_11.csv",
            "datasets/traffic_v2/710/2016_12.csv",
            "datasets/traffic_v2/710/2017_1.csv",
            "datasets/traffic_v2/710/2017_2.csv",
            "datasets/traffic_v2/710/2017_3.csv",
            "datasets/traffic_v2/710/2017_4.csv",
        ],
        [
            "datasets/traffic_v2/405/2016_10.csv",
            "datasets/traffic_v2/405/2016_11.csv",
            "datasets/traffic_v2/405/2016_12.csv",
            "datasets/traffic_v2/405/2017_1.csv",
            "datasets/traffic_v2/405/2017_2.csv",
            "datasets/traffic_v2/405/2017_3.csv",
            "datasets/traffic_v2/405/2017_4.csv",
        ],
    ],
    target_sources=[
        [
            "datasets/traffic_v2/360/2017_11.csv",
            "datasets/traffic_v2/360/2017_12.csv",
            "datasets/traffic_v2/360/2018_1.csv",
            "datasets/traffic_v2/360/2018_2.csv",
            "datasets/traffic_v2/360/2018_3.csv",
            "datasets/traffic_v2/360/2018_4.csv",
            "datasets/traffic_v2/360/2018_5.csv",
        ],
        [
            "datasets/traffic_v2/360/2017_8.csv",
            "datasets/traffic_v2/360/2017_9.csv",
            "datasets/traffic_v2/360/2017_10.csv",
            "datasets/traffic_v2/360/2017_11.csv",
            "datasets/traffic_v2/360/2017_12.csv",
            "datasets/traffic_v2/360/2018_1.csv",
            "datasets/traffic_v2/360/2018_2.csv",
        ],
    ],
    shape=ShapeConfig(
        n_sequence=240,
        n_context=10,
        n_examples=8,
        n_features=1,
        n_heldout=2,
        n_prompt=60,
    ),
    T_mapping=partial(normalize, maximum=1, minimum=-3),
    V_mapping=normalize_V_mean_2std,
    name="traffic",
)


etl = dict(
    context_sources=[
        [
            "datasets/etl_v1/208/2018_4_1.csv",
            "datasets/etl_v1/208/2018_4_2.csv",
            "datasets/etl_v1/208/2018_4_3.csv",
            "datasets/etl_v1/208/2018_4_4.csv",
            "datasets/etl_v1/208/2018_4_5.csv",
            "datasets/etl_v1/208/2018_4_6.csv",
            "datasets/etl_v1/208/2018_4_7.csv",
            "datasets/etl_v1/208/2018_4_8.csv",
            "datasets/etl_v1/208/2018_4_9.csv",
            "datasets/etl_v1/208/2018_4_10.csv",
            "datasets/etl_v1/208/2018_4_11.csv",
            "datasets/etl_v1/208/2018_4_12.csv",
            "datasets/etl_v1/208/2018_4_13.csv",
            "datasets/etl_v1/208/2018_4_14.csv",
        ],
        [
            "datasets/etl_v1/208/2018_4_7.csv",
            "datasets/etl_v1/208/2018_4_8.csv",
            "datasets/etl_v1/208/2018_4_9.csv",
            "datasets/etl_v1/208/2018_4_10.csv",
            "datasets/etl_v1/208/2018_4_11.csv",
            "datasets/etl_v1/208/2018_4_12.csv",
            "datasets/etl_v1/208/2018_4_13.csv",
            "datasets/etl_v1/208/2018_4_14.csv",
            "datasets/etl_v1/208/2018_4_15.csv",
            "datasets/etl_v1/208/2018_4_16.csv",
            "datasets/etl_v1/208/2018_4_17.csv",
            "datasets/etl_v1/208/2018_4_18.csv",
            "datasets/etl_v1/208/2018_4_19.csv",
            "datasets/etl_v1/208/2018_4_20.csv",
        ],
        [
            "datasets/etl_v1/208/2018_4_17.csv",
            "datasets/etl_v1/208/2018_4_18.csv",
            "datasets/etl_v1/208/2018_4_19.csv",
            "datasets/etl_v1/208/2018_4_20.csv",
            "datasets/etl_v1/208/2018_4_21.csv",
            "datasets/etl_v1/208/2018_4_22.csv",
            "datasets/etl_v1/208/2018_4_23.csv",
            "datasets/etl_v1/208/2018_4_24.csv",
            "datasets/etl_v1/208/2018_4_25.csv",
            "datasets/etl_v1/208/2018_4_26.csv",
            "datasets/etl_v1/208/2018_4_27.csv",
            "datasets/etl_v1/208/2018_4_28.csv",
            "datasets/etl_v1/208/2018_4_29.csv",
            "datasets/etl_v1/208/2018_4_30.csv",
        ],
        [
            "datasets/etl_v1/208/2017_4_1.csv",
            "datasets/etl_v1/208/2017_4_2.csv",
            "datasets/etl_v1/208/2017_4_3.csv",
            "datasets/etl_v1/208/2017_4_4.csv",
            "datasets/etl_v1/208/2017_4_5.csv",
            "datasets/etl_v1/208/2017_4_6.csv",
            "datasets/etl_v1/208/2017_4_7.csv",
            "datasets/etl_v1/208/2017_4_8.csv",
            "datasets/etl_v1/208/2017_4_9.csv",
            "datasets/etl_v1/208/2017_4_10.csv",
            "datasets/etl_v1/208/2017_4_11.csv",
            "datasets/etl_v1/208/2017_4_12.csv",
            "datasets/etl_v1/208/2017_4_13.csv",
            "datasets/etl_v1/208/2017_4_14.csv",
        ],
        [
            "datasets/etl_v1/208/2017_4_7.csv",
            "datasets/etl_v1/208/2017_4_8.csv",
            "datasets/etl_v1/208/2017_4_9.csv",
            "datasets/etl_v1/208/2017_4_10.csv",
            "datasets/etl_v1/208/2017_4_11.csv",
            "datasets/etl_v1/208/2017_4_12.csv",
            "datasets/etl_v1/208/2017_4_13.csv",
            "datasets/etl_v1/208/2017_4_14.csv",
            "datasets/etl_v1/208/2017_4_15.csv",
            "datasets/etl_v1/208/2017_4_16.csv",
            "datasets/etl_v1/208/2017_4_17.csv",
            "datasets/etl_v1/208/2017_4_18.csv",
            "datasets/etl_v1/208/2017_4_19.csv",
            "datasets/etl_v1/208/2017_4_20.csv",
        ],
        [
            "datasets/etl_v1/208/2017_4_17.csv",
            "datasets/etl_v1/208/2017_4_18.csv",
            "datasets/etl_v1/208/2017_4_19.csv",
            "datasets/etl_v1/208/2017_4_20.csv",
            "datasets/etl_v1/208/2017_4_21.csv",
            "datasets/etl_v1/208/2017_4_22.csv",
            "datasets/etl_v1/208/2017_4_23.csv",
            "datasets/etl_v1/208/2017_4_24.csv",
            "datasets/etl_v1/208/2017_4_25.csv",
            "datasets/etl_v1/208/2017_4_26.csv",
            "datasets/etl_v1/208/2017_4_27.csv",
            "datasets/etl_v1/208/2017_4_28.csv",
            "datasets/etl_v1/208/2017_4_29.csv",
            "datasets/etl_v1/208/2017_4_30.csv",
        ],
        [
            "datasets/etl_v1/208/2019_1_1.csv",
            "datasets/etl_v1/208/2019_1_2.csv",
            "datasets/etl_v1/208/2019_1_3.csv",
            "datasets/etl_v1/208/2019_1_4.csv",
            "datasets/etl_v1/208/2019_1_5.csv",
            "datasets/etl_v1/208/2019_1_6.csv",
            "datasets/etl_v1/208/2019_1_7.csv",
            "datasets/etl_v1/208/2019_1_8.csv",
            "datasets/etl_v1/208/2019_1_9.csv",
            "datasets/etl_v1/208/2019_1_10.csv",
            "datasets/etl_v1/208/2019_1_11.csv",
            "datasets/etl_v1/208/2019_1_12.csv",
            "datasets/etl_v1/208/2019_1_13.csv",
            "datasets/etl_v1/208/2019_1_14.csv",
        ],
        [
            "datasets/etl_v1/208/2019_1_7.csv",
            "datasets/etl_v1/208/2019_1_8.csv",
            "datasets/etl_v1/208/2019_1_9.csv",
            "datasets/etl_v1/208/2019_1_10.csv",
            "datasets/etl_v1/208/2019_1_11.csv",
            "datasets/etl_v1/208/2019_1_12.csv",
            "datasets/etl_v1/208/2019_1_13.csv",
            "datasets/etl_v1/208/2019_1_14.csv",
            "datasets/etl_v1/208/2019_1_15.csv",
            "datasets/etl_v1/208/2019_1_16.csv",
            "datasets/etl_v1/208/2019_1_17.csv",
            "datasets/etl_v1/208/2019_1_18.csv",
            "datasets/etl_v1/208/2019_1_19.csv",
            "datasets/etl_v1/208/2019_1_20.csv",
        ],
        [
            "datasets/etl_v1/208/2019_1_17.csv",
            "datasets/etl_v1/208/2019_1_18.csv",
            "datasets/etl_v1/208/2019_1_19.csv",
            "datasets/etl_v1/208/2019_1_20.csv",
            "datasets/etl_v1/208/2019_1_21.csv",
            "datasets/etl_v1/208/2019_1_22.csv",
            "datasets/etl_v1/208/2019_1_23.csv",
            "datasets/etl_v1/208/2019_1_24.csv",
            "datasets/etl_v1/208/2019_1_25.csv",
            "datasets/etl_v1/208/2019_1_26.csv",
            "datasets/etl_v1/208/2019_1_27.csv",
            "datasets/etl_v1/208/2019_1_28.csv",
            "datasets/etl_v1/208/2019_1_29.csv",
            "datasets/etl_v1/208/2019_1_30.csv",
        ],
        [
            "datasets/etl_v1/208/2019_2_1.csv",
            "datasets/etl_v1/208/2019_2_2.csv",
            "datasets/etl_v1/208/2019_2_3.csv",
            "datasets/etl_v1/208/2019_2_4.csv",
            "datasets/etl_v1/208/2019_2_5.csv",
            "datasets/etl_v1/208/2019_2_6.csv",
            "datasets/etl_v1/208/2019_2_7.csv",
            "datasets/etl_v1/208/2019_2_8.csv",
            "datasets/etl_v1/208/2019_2_9.csv",
            "datasets/etl_v1/208/2019_2_10.csv",
            "datasets/etl_v1/208/2019_2_11.csv",
            "datasets/etl_v1/208/2019_2_12.csv",
            "datasets/etl_v1/208/2019_2_13.csv",
            "datasets/etl_v1/208/2019_2_14.csv",
        ],
        [
            "datasets/etl_v1/208/2019_2_7.csv",
            "datasets/etl_v1/208/2019_2_8.csv",
            "datasets/etl_v1/208/2019_2_9.csv",
            "datasets/etl_v1/208/2019_2_10.csv",
            "datasets/etl_v1/208/2019_2_11.csv",
            "datasets/etl_v1/208/2019_2_12.csv",
            "datasets/etl_v1/208/2019_2_13.csv",
            "datasets/etl_v1/208/2019_2_14.csv",
            "datasets/etl_v1/208/2019_2_15.csv",
            "datasets/etl_v1/208/2019_2_16.csv",
            "datasets/etl_v1/208/2019_2_17.csv",
            "datasets/etl_v1/208/2019_2_18.csv",
            "datasets/etl_v1/208/2019_2_19.csv",
            "datasets/etl_v1/208/2019_2_20.csv",
        ],
        [
            "datasets/etl_v1/208/2019_2_17.csv",
            "datasets/etl_v1/208/2019_2_18.csv",
            "datasets/etl_v1/208/2019_2_19.csv",
            "datasets/etl_v1/208/2019_2_20.csv",
            "datasets/etl_v1/208/2019_2_21.csv",
            "datasets/etl_v1/208/2019_2_22.csv",
            "datasets/etl_v1/208/2019_2_23.csv",
            "datasets/etl_v1/208/2019_2_24.csv",
            "datasets/etl_v1/208/2019_2_25.csv",
            "datasets/etl_v1/208/2019_2_26.csv",
            "datasets/etl_v1/208/2019_2_27.csv",
            "datasets/etl_v1/208/2019_2_28.csv",
            "datasets/etl_v1/208/2019_3_1.csv",
            "datasets/etl_v1/208/2019_3_2.csv",
        ],
        [
            "datasets/etl_v1/208/2019_3_1.csv",
            "datasets/etl_v1/208/2019_3_2.csv",
            "datasets/etl_v1/208/2019_3_3.csv",
            "datasets/etl_v1/208/2019_3_4.csv",
            "datasets/etl_v1/208/2019_3_5.csv",
            "datasets/etl_v1/208/2019_3_6.csv",
            "datasets/etl_v1/208/2019_3_7.csv",
            "datasets/etl_v1/208/2019_3_8.csv",
            "datasets/etl_v1/208/2019_3_9.csv",
            "datasets/etl_v1/208/2019_3_10.csv",
            "datasets/etl_v1/208/2019_3_11.csv",
            "datasets/etl_v1/208/2019_3_12.csv",
            "datasets/etl_v1/208/2019_3_13.csv",
            "datasets/etl_v1/208/2019_3_14.csv",
        ],
        [
            "datasets/etl_v1/208/2019_3_7.csv",
            "datasets/etl_v1/208/2019_3_8.csv",
            "datasets/etl_v1/208/2019_3_9.csv",
            "datasets/etl_v1/208/2019_3_10.csv",
            "datasets/etl_v1/208/2019_3_11.csv",
            "datasets/etl_v1/208/2019_3_12.csv",
            "datasets/etl_v1/208/2019_3_13.csv",
            "datasets/etl_v1/208/2019_3_14.csv",
            "datasets/etl_v1/208/2019_3_15.csv",
            "datasets/etl_v1/208/2019_3_16.csv",
            "datasets/etl_v1/208/2019_3_17.csv",
            "datasets/etl_v1/208/2019_3_18.csv",
            "datasets/etl_v1/208/2019_3_19.csv",
            "datasets/etl_v1/208/2019_3_20.csv",
        ],
        [
            "datasets/etl_v1/208/2019_3_17.csv",
            "datasets/etl_v1/208/2019_3_18.csv",
            "datasets/etl_v1/208/2019_3_19.csv",
            "datasets/etl_v1/208/2019_3_20.csv",
            "datasets/etl_v1/208/2019_3_21.csv",
            "datasets/etl_v1/208/2019_3_22.csv",
            "datasets/etl_v1/208/2019_3_23.csv",
            "datasets/etl_v1/208/2019_3_24.csv",
            "datasets/etl_v1/208/2019_3_25.csv",
            "datasets/etl_v1/208/2019_3_26.csv",
            "datasets/etl_v1/208/2019_3_27.csv",
            "datasets/etl_v1/208/2019_3_28.csv",
            "datasets/etl_v1/208/2019_3_29.csv",
            "datasets/etl_v1/208/2019_3_30.csv",
        ],
        [
            "datasets/etl_v1/313/2018_4_1.csv",
            "datasets/etl_v1/313/2018_4_2.csv",
            "datasets/etl_v1/313/2018_4_3.csv",
            "datasets/etl_v1/313/2018_4_4.csv",
            "datasets/etl_v1/313/2018_4_5.csv",
            "datasets/etl_v1/313/2018_4_6.csv",
            "datasets/etl_v1/313/2018_4_7.csv",
            "datasets/etl_v1/313/2018_4_8.csv",
            "datasets/etl_v1/313/2018_4_9.csv",
            "datasets/etl_v1/313/2018_4_10.csv",
            "datasets/etl_v1/313/2018_4_11.csv",
            "datasets/etl_v1/313/2018_4_12.csv",
            "datasets/etl_v1/313/2018_4_13.csv",
            "datasets/etl_v1/313/2018_4_14.csv",
        ],
        [
            "datasets/etl_v1/313/2018_4_7.csv",
            "datasets/etl_v1/313/2018_4_8.csv",
            "datasets/etl_v1/313/2018_4_9.csv",
            "datasets/etl_v1/313/2018_4_10.csv",
            "datasets/etl_v1/313/2018_4_11.csv",
            "datasets/etl_v1/313/2018_4_12.csv",
            "datasets/etl_v1/313/2018_4_13.csv",
            "datasets/etl_v1/313/2018_4_14.csv",
            "datasets/etl_v1/313/2018_4_15.csv",
            "datasets/etl_v1/313/2018_4_16.csv",
            "datasets/etl_v1/313/2018_4_17.csv",
            "datasets/etl_v1/313/2018_4_18.csv",
            "datasets/etl_v1/313/2018_4_19.csv",
            "datasets/etl_v1/313/2018_4_20.csv",
        ],
        [
            "datasets/etl_v1/313/2018_4_17.csv",
            "datasets/etl_v1/313/2018_4_18.csv",
            "datasets/etl_v1/313/2018_4_19.csv",
            "datasets/etl_v1/313/2018_4_20.csv",
            "datasets/etl_v1/313/2018_4_21.csv",
            "datasets/etl_v1/313/2018_4_22.csv",
            "datasets/etl_v1/313/2018_4_23.csv",
            "datasets/etl_v1/313/2018_4_24.csv",
            "datasets/etl_v1/313/2018_4_25.csv",
            "datasets/etl_v1/313/2018_4_26.csv",
            "datasets/etl_v1/313/2018_4_27.csv",
            "datasets/etl_v1/313/2018_4_28.csv",
            "datasets/etl_v1/313/2018_4_29.csv",
            "datasets/etl_v1/313/2018_4_30.csv",
        ],
        [
            "datasets/etl_v1/313/2017_4_1.csv",
            "datasets/etl_v1/313/2017_4_2.csv",
            "datasets/etl_v1/313/2017_4_3.csv",
            "datasets/etl_v1/313/2017_4_4.csv",
            "datasets/etl_v1/313/2017_4_5.csv",
            "datasets/etl_v1/313/2017_4_6.csv",
            "datasets/etl_v1/313/2017_4_7.csv",
            "datasets/etl_v1/313/2017_4_8.csv",
            "datasets/etl_v1/313/2017_4_9.csv",
            "datasets/etl_v1/313/2017_4_10.csv",
            "datasets/etl_v1/313/2017_4_11.csv",
            "datasets/etl_v1/313/2017_4_12.csv",
            "datasets/etl_v1/313/2017_4_13.csv",
            "datasets/etl_v1/313/2017_4_14.csv",
        ],
        [
            "datasets/etl_v1/313/2017_4_7.csv",
            "datasets/etl_v1/313/2017_4_8.csv",
            "datasets/etl_v1/313/2017_4_9.csv",
            "datasets/etl_v1/313/2017_4_10.csv",
            "datasets/etl_v1/313/2017_4_11.csv",
            "datasets/etl_v1/313/2017_4_12.csv",
            "datasets/etl_v1/313/2017_4_13.csv",
            "datasets/etl_v1/313/2017_4_14.csv",
            "datasets/etl_v1/313/2017_4_15.csv",
            "datasets/etl_v1/313/2017_4_16.csv",
            "datasets/etl_v1/313/2017_4_17.csv",
            "datasets/etl_v1/313/2017_4_18.csv",
            "datasets/etl_v1/313/2017_4_19.csv",
            "datasets/etl_v1/313/2017_4_20.csv",
        ],
        [
            "datasets/etl_v1/313/2017_4_17.csv",
            "datasets/etl_v1/313/2017_4_18.csv",
            "datasets/etl_v1/313/2017_4_19.csv",
            "datasets/etl_v1/313/2017_4_20.csv",
            "datasets/etl_v1/313/2017_4_21.csv",
            "datasets/etl_v1/313/2017_4_22.csv",
            "datasets/etl_v1/313/2017_4_23.csv",
            "datasets/etl_v1/313/2017_4_24.csv",
            "datasets/etl_v1/313/2017_4_25.csv",
            "datasets/etl_v1/313/2017_4_26.csv",
            "datasets/etl_v1/313/2017_4_27.csv",
            "datasets/etl_v1/313/2017_4_28.csv",
            "datasets/etl_v1/313/2017_4_29.csv",
            "datasets/etl_v1/313/2017_4_30.csv",
        ],
        [
            "datasets/etl_v1/313/2019_1_1.csv",
            "datasets/etl_v1/313/2019_1_2.csv",
            "datasets/etl_v1/313/2019_1_3.csv",
            "datasets/etl_v1/313/2019_1_4.csv",
            "datasets/etl_v1/313/2019_1_5.csv",
            "datasets/etl_v1/313/2019_1_6.csv",
            "datasets/etl_v1/313/2019_1_7.csv",
            "datasets/etl_v1/313/2019_1_8.csv",
            "datasets/etl_v1/313/2019_1_9.csv",
            "datasets/etl_v1/313/2019_1_10.csv",
            "datasets/etl_v1/313/2019_1_11.csv",
            "datasets/etl_v1/313/2019_1_12.csv",
            "datasets/etl_v1/313/2019_1_13.csv",
            "datasets/etl_v1/313/2019_1_14.csv",
        ],
        [
            "datasets/etl_v1/313/2019_1_7.csv",
            "datasets/etl_v1/313/2019_1_8.csv",
            "datasets/etl_v1/313/2019_1_9.csv",
            "datasets/etl_v1/313/2019_1_10.csv",
            "datasets/etl_v1/313/2019_1_11.csv",
            "datasets/etl_v1/313/2019_1_12.csv",
            "datasets/etl_v1/313/2019_1_13.csv",
            "datasets/etl_v1/313/2019_1_14.csv",
            "datasets/etl_v1/313/2019_1_15.csv",
            "datasets/etl_v1/313/2019_1_16.csv",
            "datasets/etl_v1/313/2019_1_17.csv",
            "datasets/etl_v1/313/2019_1_18.csv",
            "datasets/etl_v1/313/2019_1_19.csv",
            "datasets/etl_v1/313/2019_1_20.csv",
        ],
        [
            "datasets/etl_v1/313/2019_1_17.csv",
            "datasets/etl_v1/313/2019_1_18.csv",
            "datasets/etl_v1/313/2019_1_19.csv",
            "datasets/etl_v1/313/2019_1_20.csv",
            "datasets/etl_v1/313/2019_1_21.csv",
            "datasets/etl_v1/313/2019_1_22.csv",
            "datasets/etl_v1/313/2019_1_23.csv",
            "datasets/etl_v1/313/2019_1_24.csv",
            "datasets/etl_v1/313/2019_1_25.csv",
            "datasets/etl_v1/313/2019_1_26.csv",
            "datasets/etl_v1/313/2019_1_27.csv",
            "datasets/etl_v1/313/2019_1_28.csv",
            "datasets/etl_v1/313/2019_1_29.csv",
            "datasets/etl_v1/313/2019_1_30.csv",
        ],
        [
            "datasets/etl_v1/313/2019_2_1.csv",
            "datasets/etl_v1/313/2019_2_2.csv",
            "datasets/etl_v1/313/2019_2_3.csv",
            "datasets/etl_v1/313/2019_2_4.csv",
            "datasets/etl_v1/313/2019_2_5.csv",
            "datasets/etl_v1/313/2019_2_6.csv",
            "datasets/etl_v1/313/2019_2_7.csv",
            "datasets/etl_v1/313/2019_2_8.csv",
            "datasets/etl_v1/313/2019_2_9.csv",
            "datasets/etl_v1/313/2019_2_10.csv",
            "datasets/etl_v1/313/2019_2_11.csv",
            "datasets/etl_v1/313/2019_2_12.csv",
            "datasets/etl_v1/313/2019_2_13.csv",
            "datasets/etl_v1/313/2019_2_14.csv",
        ],
        [
            "datasets/etl_v1/313/2019_2_7.csv",
            "datasets/etl_v1/313/2019_2_8.csv",
            "datasets/etl_v1/313/2019_2_9.csv",
            "datasets/etl_v1/313/2019_2_10.csv",
            "datasets/etl_v1/313/2019_2_11.csv",
            "datasets/etl_v1/313/2019_2_12.csv",
            "datasets/etl_v1/313/2019_2_13.csv",
            "datasets/etl_v1/313/2019_2_14.csv",
            "datasets/etl_v1/313/2019_2_15.csv",
            "datasets/etl_v1/313/2019_2_16.csv",
            "datasets/etl_v1/313/2019_2_17.csv",
            "datasets/etl_v1/313/2019_2_18.csv",
            "datasets/etl_v1/313/2019_2_19.csv",
            "datasets/etl_v1/313/2019_2_20.csv",
        ],
        [
            "datasets/etl_v1/313/2019_2_17.csv",
            "datasets/etl_v1/313/2019_2_18.csv",
            "datasets/etl_v1/313/2019_2_19.csv",
            "datasets/etl_v1/313/2019_2_20.csv",
            "datasets/etl_v1/313/2019_2_21.csv",
            "datasets/etl_v1/313/2019_2_22.csv",
            "datasets/etl_v1/313/2019_2_23.csv",
            "datasets/etl_v1/313/2019_2_24.csv",
            "datasets/etl_v1/313/2019_2_25.csv",
            "datasets/etl_v1/313/2019_2_26.csv",
            "datasets/etl_v1/313/2019_2_27.csv",
            "datasets/etl_v1/313/2019_2_28.csv",
            "datasets/etl_v1/313/2019_3_1.csv",
            "datasets/etl_v1/313/2019_3_2.csv",
        ],
        [
            "datasets/etl_v1/313/2019_3_1.csv",
            "datasets/etl_v1/313/2019_3_2.csv",
            "datasets/etl_v1/313/2019_3_3.csv",
            "datasets/etl_v1/313/2019_3_4.csv",
            "datasets/etl_v1/313/2019_3_5.csv",
            "datasets/etl_v1/313/2019_3_6.csv",
            "datasets/etl_v1/313/2019_3_7.csv",
            "datasets/etl_v1/313/2019_3_8.csv",
            "datasets/etl_v1/313/2019_3_9.csv",
            "datasets/etl_v1/313/2019_3_10.csv",
            "datasets/etl_v1/313/2019_3_11.csv",
            "datasets/etl_v1/313/2019_3_12.csv",
            "datasets/etl_v1/313/2019_3_13.csv",
            "datasets/etl_v1/313/2019_3_14.csv",
        ],
        [
            "datasets/etl_v1/313/2019_3_7.csv",
            "datasets/etl_v1/313/2019_3_8.csv",
            "datasets/etl_v1/313/2019_3_9.csv",
            "datasets/etl_v1/313/2019_3_10.csv",
            "datasets/etl_v1/313/2019_3_11.csv",
            "datasets/etl_v1/313/2019_3_12.csv",
            "datasets/etl_v1/313/2019_3_13.csv",
            "datasets/etl_v1/313/2019_3_14.csv",
            "datasets/etl_v1/313/2019_3_15.csv",
            "datasets/etl_v1/313/2019_3_16.csv",
            "datasets/etl_v1/313/2019_3_17.csv",
            "datasets/etl_v1/313/2019_3_18.csv",
            "datasets/etl_v1/313/2019_3_19.csv",
            "datasets/etl_v1/313/2019_3_20.csv",
        ],
        [
            "datasets/etl_v1/313/2019_3_17.csv",
            "datasets/etl_v1/313/2019_3_18.csv",
            "datasets/etl_v1/313/2019_3_19.csv",
            "datasets/etl_v1/313/2019_3_20.csv",
            "datasets/etl_v1/313/2019_3_21.csv",
            "datasets/etl_v1/313/2019_3_22.csv",
            "datasets/etl_v1/313/2019_3_23.csv",
            "datasets/etl_v1/313/2019_3_24.csv",
            "datasets/etl_v1/313/2019_3_25.csv",
            "datasets/etl_v1/313/2019_3_26.csv",
            "datasets/etl_v1/313/2019_3_27.csv",
            "datasets/etl_v1/313/2019_3_28.csv",
            "datasets/etl_v1/313/2019_3_29.csv",
            "datasets/etl_v1/313/2019_3_30.csv",
        ],
    ],
    target_sources=[
        [
            "datasets/etl_v1/OT/2019_5_1.csv",
            "datasets/etl_v1/OT/2019_5_2.csv",
            "datasets/etl_v1/OT/2019_5_3.csv",
            "datasets/etl_v1/OT/2019_5_4.csv",
            "datasets/etl_v1/OT/2019_5_5.csv",
            "datasets/etl_v1/OT/2019_5_6.csv",
            "datasets/etl_v1/OT/2019_5_7.csv",
            "datasets/etl_v1/OT/2019_5_8.csv",
            "datasets/etl_v1/OT/2019_5_9.csv",
            "datasets/etl_v1/OT/2019_5_10.csv",
            "datasets/etl_v1/OT/2019_5_11.csv",
            "datasets/etl_v1/OT/2019_5_12.csv",
            "datasets/etl_v1/OT/2019_5_13.csv",
            "datasets/etl_v1/OT/2019_5_14.csv",
        ],
        [
            "datasets/etl_v1/OT/2019_4_1.csv",
            "datasets/etl_v1/OT/2019_4_2.csv",
            "datasets/etl_v1/OT/2019_4_3.csv",
            "datasets/etl_v1/OT/2019_4_4.csv",
            "datasets/etl_v1/OT/2019_4_5.csv",
            "datasets/etl_v1/OT/2019_4_6.csv",
            "datasets/etl_v1/OT/2019_4_7.csv",
            "datasets/etl_v1/OT/2019_4_8.csv",
            "datasets/etl_v1/OT/2019_4_9.csv",
            "datasets/etl_v1/OT/2019_4_10.csv",
            "datasets/etl_v1/OT/2019_4_11.csv",
            "datasets/etl_v1/OT/2019_4_12.csv",
            "datasets/etl_v1/OT/2019_4_13.csv",
            "datasets/etl_v1/OT/2019_4_14.csv",
        ],
    ],
    shape=ShapeConfig(
        n_sequence=240,
        n_context=32,
        n_examples=30,
        n_features=1,
        n_heldout=2,
        n_prompt=60,
    ),
    T_mapping=partial(normalize, maximum=1, minimum=-3),
    V_mapping=normalize_V_mean_2std,
    stride=10,
    name="etl",
)


def initialize_loader(dataset, config):
    return DataLoader(
        dataset(),
        batch_size=config.batch_size_val,
    )


def create_eval_dataloaders(
    config,
    illness_eval_config=illness_eval_config,
    ett_h_1_eval_config=ett_h_1_eval_config,
    ett_h_2_eval_config=ett_h_2_eval_config,
    etl=etl,
    traffic_eval_config=traffic_eval_config,
    use_infinity_loader=True,
):

    real_evals = {
        "ett_h_1": partial(
            RealCSVDataset,
            batch_size=config.batch_size_val,
            **ett_h_1_eval_config,
            is_train=False,
            device="cpu",
            dataset_name="ett_h_1",
        ),
        "ett_h_2": partial(
            RealCSVDataset,
            batch_size=config.batch_size_val,
            **ett_h_2_eval_config,
            is_train=False,
            device="cpu",
            dataset_name="ett_h_2",
        ),
        "traffic": partial(
            RealCSVDataset,
            batch_size=config.batch_size_val,
            **traffic_eval_config,
            is_train=False,
            device="cpu",
            dataset_name="traffic",
        ),
        "etl": partial(
            RealCSVDataset,
            batch_size=config.batch_size_val,
            **etl,
            is_train=False,
            device="cpu",
            dataset_name="etl",
        ),
        "illness": partial(
            RealCSVDataset,
            batch_size=config.batch_size_val,
            **illness_eval_config,
            is_train=False,
            device="cpu",
            dataset_name="illness",
        ),
    }

    return {
        key: (
            iter(
                infinite_dataloader(
                    DataLoader(
                        dataset(),
                        batch_size=config.batch_size_val,
                    )
                )
            )
            if use_infinity_loader
            else partial(
                initialize_loader,
                dataset,
                config,
            )
        )
        for key, dataset in real_evals.items()
    }
